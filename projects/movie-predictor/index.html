<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Movie Rating Predictor Service | Martín E. Bravo </title> <meta name="author" content="Martín E. Bravo"> <meta name="description" content="This project is a serverless ML system that predicts IMDb ratings for movies using a dynamic dataset from Kaggle."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://martinebravo.github.io/projects/movie-predictor/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Martín</span> E. Bravo </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Movie Rating Predictor Service</h1> <p class="post-description">This project is a serverless ML system that predicts IMDb ratings for movies using a dynamic dataset from Kaggle.</p> </header> <article> <h2 id="overview">Overview</h2> <p>This project is a serverless ML system that predicts IMDb ratings for movies using a dynamic dataset from <a href="https://www.kaggle.com/datasets/alanvourch/tmdb-movies-daily-updates/data" rel="external nofollow noopener" target="_blank">Kaggle</a>. The system comprises four main pipelines:</p> <ol> <li> <strong>Historical Data Pipeline</strong>: Backfills the feature store with historical data.</li> <li> <strong>Feature Pipeline</strong>: Handles daily data updates.</li> <li> <strong>Training Pipeline</strong>: Trains the machine learning model.</li> <li> <strong>Inference Pipeline</strong>: Uses the trained model to predict ratings for new movies.</li> </ol> <p>A user interface (UI) is available for monitoring predictions. The website allows users to explore different movies, view predicted ratings, and navigate to the IMDb page of a selected movie to see its actual IMDb rating.</p> <p>Key technologies used include Hopsworks for the feature store and GitHub Actions for automating daily workflows and pipeline execution.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/movie/pipeline-480.webp 480w,/assets/img/projects/movie/pipeline-800.webp 800w,/assets/img/projects/movie/pipeline-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/movie/pipeline.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Pipeline Overview" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The website is available at <a href="https://martinebravo.github.io/movie-rating-predictor-service/">Movie Rating Predictor</a>.</p> <p>We can see the predicted ratings for 20 newly updated movies. If we click on the movie poster, we will be redirected to the IMDb page of the movie to see the actual IMDb rating.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/projects/movie/web-480.webp 480w,/assets/img/projects/movie/web-800.webp 800w,/assets/img/projects/movie/web-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/projects/movie/web.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Website Screenshot" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <hr> <h2 id="dataset">Dataset</h2> <p>The dataset used is from <a href="https://www.kaggle.com/datasets/alanvourch/tmdb-movies-daily-updates/data" rel="external nofollow noopener" target="_blank">Kaggle</a>, containing the complete movie list from The Movie Database (TMDB) along with IMDb information. It includes 28 columns, such as:</p> <ul> <li> <code class="language-plaintext highlighter-rouge">vote_average</code>, <code class="language-plaintext highlighter-rouge">vote_count</code>, <code class="language-plaintext highlighter-rouge">status</code>, <code class="language-plaintext highlighter-rouge">release_date</code>, <code class="language-plaintext highlighter-rouge">revenue</code>, <code class="language-plaintext highlighter-rouge">runtime</code>, <code class="language-plaintext highlighter-rouge">budget</code> </li> <li> <code class="language-plaintext highlighter-rouge">imdb_rating</code>, <code class="language-plaintext highlighter-rouge">imdb_votes</code>, <code class="language-plaintext highlighter-rouge">original_language</code>, <code class="language-plaintext highlighter-rouge">overview</code>, <code class="language-plaintext highlighter-rouge">popularity</code>, <code class="language-plaintext highlighter-rouge">tagline</code> </li> <li> <code class="language-plaintext highlighter-rouge">genres</code>, <code class="language-plaintext highlighter-rouge">production_companies</code>, <code class="language-plaintext highlighter-rouge">production_countries</code>, <code class="language-plaintext highlighter-rouge">cast</code>, <code class="language-plaintext highlighter-rouge">producers</code>, <code class="language-plaintext highlighter-rouge">directors</code>, <code class="language-plaintext highlighter-rouge">writers</code> </li> </ul> <p>The dataset is updated daily, ensuring its dynamic nature.</p> <hr> <h2 id="methodology">Methodology</h2> <h3 id="historical-backfilling">Historical Backfilling</h3> <p>Historical data backfilling was done by filtering movies with the <code class="language-plaintext highlighter-rouge">status</code> set to “Released,” ensuring that IMDb ratings were available for training. Missing data columns were dropped, and data cleaning was performed.</p> <h3 id="feature-engineering">Feature Engineering</h3> <p>Features <code class="language-plaintext highlighter-rouge">vote_average</code> and <code class="language-plaintext highlighter-rouge">popularity</code> were removed since they can be seen as measures of the movie’s rating, which would bias the model. The target to predict was <code class="language-plaintext highlighter-rouge">imdb_rating</code>, making <code class="language-plaintext highlighter-rouge">vote_count</code> also irrelevant. The <code class="language-plaintext highlighter-rouge">release_date</code> column was converted to <code class="language-plaintext highlighter-rouge">release_year</code>, grouping movies by year.</p> <p>New features were derived:</p> <ul> <li> <strong>First values</strong> from <code class="language-plaintext highlighter-rouge">producers</code>, <code class="language-plaintext highlighter-rouge">cast</code>, and <code class="language-plaintext highlighter-rouge">production_companies</code> columns were extracted into <code class="language-plaintext highlighter-rouge">first_producer</code>, <code class="language-plaintext highlighter-rouge">first_actor</code>, and <code class="language-plaintext highlighter-rouge">first_company</code> and label-encoded.</li> <li>The <code class="language-plaintext highlighter-rouge">genres</code> column was one-hot encoded, creating a separate feature group that was merged in the training pipeline.</li> </ul> <p>Including the categorical feature <code class="language-plaintext highlighter-rouge">original_language</code> improved model performance, leading to lower MSE and higher R-squared values.</p> <p>Final features used for training included:</p> <ul> <li> <code class="language-plaintext highlighter-rouge">budget</code>, <code class="language-plaintext highlighter-rouge">runtime</code>, <code class="language-plaintext highlighter-rouge">release_year</code>, <code class="language-plaintext highlighter-rouge">imdb_votes</code> </li> <li> <code class="language-plaintext highlighter-rouge">first_producer</code>, <code class="language-plaintext highlighter-rouge">first_actor</code>, <code class="language-plaintext highlighter-rouge">first_company</code>, <code class="language-plaintext highlighter-rouge">original_language</code> </li> <li>One-hot encoded <code class="language-plaintext highlighter-rouge">genres</code> (19 unique genres)</li> </ul> <p>This resulted in a total of <strong>27 features</strong>.</p> <h3 id="models">Models</h3> <p>The following models were compared:</p> <ul> <li>XGB Regressor</li> <li>Random Forest Regression</li> <li>Linear Regression</li> <li>SVR</li> <li>Decision Tree Regressor</li> </ul> <p>The <strong>XGB Regressor</strong> emerged as the best-performing model, with an MSE of 0.54 and an R-squared value of 0.58. The Random Forest Regressor performed closely, offering simplicity and adaptability for varying dataset sizes.</p> <h3 id="inference-pipeline">Inference Pipeline</h3> <p>For the inference pipeline, predictions were made for:</p> <ol> <li>Newly released movies.</li> <li>Movies in “Post Production” status (with estimated <code class="language-plaintext highlighter-rouge">imdb_votes</code> of 400 and average runtime of 124 minutes).</li> </ol> <p>The website displays both predicted and actual IMDb ratings for 20 newly updated movies.</p> <hr> <h2 id="results">Results</h2> <p>The results demonstrate the effectiveness of the XGB Regressor. Below is a sample comparison of predicted and actual IMDb ratings:</p> <table> <thead> <tr> <th>Predicted</th> <th>Actual</th> </tr> </thead> <tbody> <tr> <td>5.857948</td> <td>7.1</td> </tr> <tr> <td>6.3983464</td> <td>6.3</td> </tr> <tr> <td>5.2628407</td> <td>6.1</td> </tr> <tr> <td>4.411699</td> <td>4.2</td> </tr> <tr> <td>5.9354286</td> <td>5.9</td> </tr> <tr> <td>6.1494517</td> <td>6.1</td> </tr> <tr> <td>4.789273</td> <td>4.4</td> </tr> <tr> <td>4.68718</td> <td>4.2</td> </tr> <tr> <td>4.7766104</td> <td>6.6</td> </tr> <tr> <td>6.090134</td> <td>6.3</td> </tr> </tbody> </table> <p>Some predictions are close to the actual ratings, while others show expected variance, reflecting the complexity of factors influencing IMDb ratings.</p> <hr> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Martín E. Bravo. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>